name: C++ CI

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    build-linux:
        name: Build on Ubuntu
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v3
            - name: Install build tools 
              run: sudo apt-get update && sudo apt-get install -y build-essential cmake
            - name: Configure CMake
              run: cmake -S . -B build
            - name: Build
              run: cmake --build build
            - name: Install library
              run: cmake --install build
            - name: Run Tests
              run: ctest --test-dir build
            - name: Run Catch2 tests
              run: ./build/my_tests

    build-windows:
        name: Build on Windows
        runs-on: windows-latest

        steps:
            - uses: actions/checkout@v3
            - name: Configure CMake
              run: cmake -S . -B build
            - name: Build
              run: cmake --build build
            - name: Install library
              run: cmake --install build
            - name: Run tests
              run: ctest --test-dir build
            - name: Run Catch2 Tests (Windows)
              run: ./build/Debug/my_tests.exe

